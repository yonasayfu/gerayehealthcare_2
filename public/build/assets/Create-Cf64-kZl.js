import{d as x,m as h,u as k,p as S,s as D,c as i,o as l,a as c,b as d,h as V,w as g,e as t,l as I,y as C,j as r,F as b,r as m,t as u,v as j,f as L,X as M,k as v,_ as P}from"./app-B0DqkaDV.js";const B={class:"bg-white border border-4 rounded-lg shadow relative m-10"},N={class:"flex items-start justify-between p-5 border-b rounded-t"},E={class:"p-6 space-y-6"},U={class:"p-4 bg-white rounded-lg shadow"},F=["value"],O={class:"rounded-lg bg-white dark:bg-background p-6 shadow-sm space-y-6"},T={key:0,class:"text-center text-gray-500 py-4"},$={key:1,class:"space-y-2 border rounded-md p-2"},z=["value"],A={class:"flex-1"},G={class:"font-mono"},X={class:"grid md:grid-cols-2 gap-4 pt-4 border-t"},q={class:"flex justify-end pt-4"},H=["disabled"],K=x({__name:"Create",props:{patients:{},selectedPatientId:{},billableVisits:{}},setup(f){const p=f,y=[{title:"Dashboard",href:route("dashboard")},{title:"Invoices",href:route("admin.invoices.index")},{title:"Create",href:route("admin.invoices.create")}],n=h(p.selectedPatientId),a=k({patient_id:p.selectedPatientId,visit_ids:[],invoice_date:new Date().toISOString().split("T")[0],due_date:new Date(new Date().setDate(new Date().getDate()+30)).toISOString().split("T")[0]});S(n,o=>{D.get(route("admin.invoices.create"),{patient_id:o},{preserveState:!0,replace:!0})});function _(){console.log("Submitting form with data:",a.data()),a.post(route("admin.invoices.store"),{onSuccess:()=>{console.log("Invoice created successfully!")},onError:o=>{console.error("Error creating invoice:",o);let e="An unknown error occurred.";typeof o=="object"&&o!==null&&(e=Object.values(o).flat().join(`
`)),alert(`Error creating invoice:
`+e)}})}return(o,e)=>(l(),i(b,null,[c(d(V),{title:"Create Invoice"}),c(P,{breadcrumbs:y},{default:g(()=>[t("div",B,[t("div",N,[e[5]||(e[5]=t("h3",{class:"text-xl font-semibold"}," Create New Invoice ",-1)),c(d(I),{href:o.route("admin.invoices.index"),type:"button",class:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center"},{default:g(()=>e[4]||(e[4]=[t("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)])),_:1,__:[4]},8,["href"])]),t("div",E,[t("div",U,[e[7]||(e[7]=t("label",{for:"patient",class:"block text-sm font-medium text-gray-700"},"Step 1: Select a Patient",-1)),r(t("select",{id:"patient","onUpdate:modelValue":e[0]||(e[0]=s=>n.value=s),class:"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5"},[e[6]||(e[6]=t("option",{disabled:"",value:""},"-- Select a Patient --",-1)),(l(!0),i(b,null,m(o.patients,s=>(l(),i("option",{key:s.id,value:s.id},u(s.full_name),9,F))),128))],512),[[j,n.value]])]),n.value?(l(),i("form",{key:0,onSubmit:L(_,["prevent"])},[t("div",O,[e[10]||(e[10]=t("h2",{class:"text-lg font-semibold"},"Step 2: Select Billable Visits",-1)),o.billableVisits.length===0?(l(),i("div",T," No billable visits found for this patient. ")):(l(),i("div",$,[(l(!0),i(b,null,m(o.billableVisits,s=>(l(),i("label",{key:s.id,class:"flex items-center gap-4 p-2 hover:bg-gray-50 rounded-md"},[r(t("input",{type:"checkbox",value:s.id,"onUpdate:modelValue":e[1]||(e[1]=w=>d(a).visit_ids=w),class:"rounded"},null,8,z),[[M,d(a).visit_ids]]),t("span",A,u(s.service_description||"Standard Visit")+" on "+u(new Date(s.scheduled_at).toLocaleDateString()),1),t("span",G,"$"+u(s.cost),1)]))),128))])),t("div",X,[t("div",null,[e[8]||(e[8]=t("label",{for:"invoice_date",class:"block text-sm font-medium"},"Invoice Date",-1)),r(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=s=>d(a).invoice_date=s),id:"invoice_date",class:"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5"},null,512),[[v,d(a).invoice_date]])]),t("div",null,[e[9]||(e[9]=t("label",{for:"due_date",class:"block text-sm font-medium"},"Due Date",-1)),r(t("input",{type:"date","onUpdate:modelValue":e[3]||(e[3]=s=>d(a).due_date=s),id:"due_date",class:"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5"},null,512),[[v,d(a).due_date]])])]),t("div",q,[t("button",{type:"submit",disabled:d(a).processing||d(a).visit_ids.length===0,class:"px-4 py-2 bg-green-600 text-white rounded-md disabled:opacity-50"}," Generate Invoice ",8,H)])])],32)):C("",!0)]),e[11]||(e[11]=t("div",{class:"p-6 border-t border-gray-200 rounded-b"},null,-1))])]),_:1})],64))}});export{K as default};
