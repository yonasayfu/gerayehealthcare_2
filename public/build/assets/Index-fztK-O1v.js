import{d as N,k as y,l as B,Q as F,x as M,c as r,o as l,a as d,u as s,g as j,w as i,b as o,i as k,e as c,F as g,m as _,r as I,t as u,p as A,S as z,h as P,n as Y}from"./app-B9ZmK4zT.js";import{_ as H}from"./AppLayout.vue_vue_type_style_index_0_lang-15zqV9G-.js";import{c as L,_ as x}from"./index-C8zLWs5I.js";import{_ as Q}from"./Label.vue_vue_type_script_setup_true_lang-oMVbpI-U.js";import{_ as G}from"./Input.vue_vue_type_script_setup_true_lang-CMAL6YUg.js";import{_ as J,a as K,b as W,c as X,d as Z,e as ee}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BhR6xIy1.js";import{_ as te}from"./_plugin-vue_export-helper-BpSdtWAT.js";import"./createContext-fsEdSFMX.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-KsBcTmDK.js";import"./RovingFocusGroup-CCdiS5NK.js";import"./format-BigqMyrM.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=L("ChevronDownIcon",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=L("ChevronUpIcon",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),se={class:"rounded-xl border border-border bg-white shadow-sm dark:border-sidebar-border dark:bg-background"},oe={class:"p-5"},ae={class:"mb-4"},le={key:0,class:"overflow-x-auto"},ne={class:"min-w-full text-left text-sm"},re={class:"flex items-center"},de={class:"flex items-center"},ie={class:"flex items-center"},ue={class:"p-2"},ce={class:"p-2"},me={class:"p-2"},fe={class:"p-2"},pe={class:"p-2 text-right"},ve={key:0,class:"flex justify-end gap-2"},_e={key:1,class:"text-xs text-muted-foreground"},ge={key:1,class:"py-10 text-center text-muted-foreground"},be={key:2,class:"mt-4 flex justify-end"},ye={key:0},ke={key:1},xe={class:"py-4"},he={key:0,class:"text-red-500 text-xs mt-1"},we=N({__name:"Index",props:{leaveRequests:{},filters:{}},setup(U){const h=U,O=[{title:"Dashboard",href:route("dashboard")},{title:"Leave Requests",href:route("admin.admin-leave-requests.index")}],b=y(h.filters.search||""),p=y(h.filters.sort_by),m=y(h.filters.sort_order);let w=null;B(b,a=>{w&&clearTimeout(w),w=setTimeout(()=>{D()},300)});const D=a=>{console.log("Applying filters (manual trigger):",{search:b.value,sort_by:p.value,sort_order:m.value,options:a}),F.get(route("admin.admin-leave-requests.index"),{search:b.value,sort_by:p.value,sort_order:m.value},{preserveState:!0,preserveScroll:!0,only:["leaveRequests","filters"]})},C=a=>{const t={staff_member:"staff_first_name",dates_requested:"start_date",status:"status"}[a]||a;p.value===t?m.value=m.value==="asc"?"desc":"asc":(p.value=t,m.value="asc"),D()},v=y(!1),f=y(null),n=M({status:"",admin_notes:""}),T=(a,e)=>{console.log("--- openUpdateDialog Triggered ---"),console.log("Request object received:",a),console.log("Intended status for form:",e),f.value=a,n.status=e,n.admin_notes=a.admin_notes||"",v.value=!0,console.log("selectedRequest.value SET TO:",f.value),console.log("form.status SET TO:",n.status),console.log("isDialogOpen SET TO:",v.value),console.log("-------------------------------")},V=()=>{if(console.log("updateRequestStatus function entered."),!f.value){console.error("ERROR: No selectedRequest.value. Dialog should not have been confirmed without one."),v.value=!1;return}console.log("--- updateRequestStatus Triggered (Submitting) ---"),console.log("Request ID for submission:",f.value.id),console.log("Form data being sent:"),console.log("  Status:",n.status),console.log("  Admin Notes:",n.admin_notes),console.log("  Form processing state:",n.processing),console.log("-------------------------------"),n.put(route("admin.admin-leave-requests.update",f.value.id),{preserveScroll:!0,onSuccess:a=>{console.log("--- Inertia PUT request SUCCESS! ---"),console.log("Backend instructed Inertia::location to refresh."),v.value=!1,n.reset(),console.log("Dialog closed, form reset."),console.log("-------------------------------")},onError:a=>{console.error("--- Inertia PUT request FAILED! ---"),console.error("Errors:",a),a&&Object.keys(a).length>0?alert("Validation failed: "+Object.values(a).join(`
`)):alert("An unknown error occurred during update. Check console and network tab."),console.log("-------------------------------")},onFinish:()=>{console.log("--- Inertia PUT request finished (success or failure). ---"),console.log("-------------------------------")}})},$=a=>a?new Date(a).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"}):"N/A",E=a=>{switch(a){case"Approved":return"bg-green-100 text-green-800";case"Denied":return"bg-red-100 text-red-800";default:return"bg-yellow-100 text-yellow-800"}};return(a,e)=>(l(),r(g,null,[d(s(j),{title:"Leave Requests Management"}),d(H,{breadcrumbs:O},{default:i(()=>[o("div",se,[e[15]||(e[15]=o("div",{class:"border-b p-5"},[o("h2",{class:"text-lg font-semibold"},"Staff Leave Requests"),o("p",{class:"mt-1 text-sm text-muted-foreground"},"Review and manage all time-off requests from staff.")],-1)),o("div",oe,[o("div",ae,[d(s(G),{modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=t=>b.value=t),placeholder:"Search by staff name, reason, or status...",class:"w-full md:w-1/2 lg:w-1/3"},null,8,["modelValue"])]),a.leaveRequests.data.length>0?(l(),r("div",le,[o("table",ne,[o("thead",null,[o("tr",null,[o("th",{class:"p-2 cursor-pointer select-none",onClick:e[1]||(e[1]=t=>C("staff_member"))},[o("div",re,[e[7]||(e[7]=c(" Staff Member ")),p.value==="staff_first_name"?(l(),r(g,{key:0},[m.value==="asc"?(l(),_(s(q),{key:0,class:"h-4 w-4 ml-1"})):(l(),_(s(S),{key:1,class:"h-4 w-4 ml-1"}))],64)):k("",!0)])]),o("th",{class:"p-2 cursor-pointer select-none",onClick:e[2]||(e[2]=t=>C("dates_requested"))},[o("div",de,[e[8]||(e[8]=c(" Dates Requested ")),p.value==="start_date"?(l(),r(g,{key:0},[m.value==="asc"?(l(),_(s(q),{key:0,class:"h-4 w-4 ml-1"})):(l(),_(s(S),{key:1,class:"h-4 w-4 ml-1"}))],64)):k("",!0)])]),e[10]||(e[10]=o("th",{class:"p-2"},"Reason",-1)),o("th",{class:"p-2 cursor-pointer select-none",onClick:e[3]||(e[3]=t=>C("status"))},[o("div",ie,[e[9]||(e[9]=c(" Status ")),p.value==="status"?(l(),r(g,{key:0},[m.value==="asc"?(l(),_(s(q),{key:0,class:"h-4 w-4 ml-1"})):(l(),_(s(S),{key:1,class:"h-4 w-4 ml-1"}))],64)):k("",!0)])]),e[11]||(e[11]=o("th",{class:"p-2 text-right"},"Actions",-1))])]),o("tbody",null,[(l(!0),r(g,null,I(a.leaveRequests.data,t=>(l(),r("tr",{key:t.id,class:"border-t"},[o("td",ue,u(t.staff.first_name)+" "+u(t.staff.last_name),1),o("td",ce,u($(t.start_date))+" - "+u($(t.end_date)),1),o("td",me,u(t.reason||"N/A"),1),o("td",fe,[o("span",{class:A(["rounded-full px-2 py-1 text-xs font-medium",E(t.status)])},u(t.status),3)]),o("td",pe,[t.status==="Pending"?(l(),r("div",ve,[d(s(x),{variant:"outline",size:"sm",onClick:R=>T(t,"Approved")},{default:i(()=>e[12]||(e[12]=[c("Approve")])),_:2,__:[12]},1032,["onClick"]),d(s(x),{variant:"destructive",size:"sm",onClick:R=>T(t,"Denied")},{default:i(()=>e[13]||(e[13]=[c("Deny")])),_:2,__:[13]},1032,["onClick"])])):(l(),r("span",_e,"Reviewed"))])]))),128))])])])):(l(),r("div",ge,e[14]||(e[14]=[o("p",null,"There are no leave requests to review.",-1)]))),a.leaveRequests.links.length>3?(l(),r("div",be,[(l(!0),r(g,null,I(a.leaveRequests.links,(t,R)=>(l(),_(s(z),{key:R,href:t.url||"#",class:A(["px-4 py-2 text-sm",{"font-bold text-primary":t.active,"text-muted-foreground":!t.active}]),innerHTML:t.label},null,8,["href","class","innerHTML"]))),128))])):k("",!0)])]),d(s(J),{open:v.value,"onUpdate:open":e[6]||(e[6]=t=>v.value=t)},{default:i(()=>[d(s(K),null,{default:i(()=>[d(s(W),null,{default:i(()=>[d(s(X),null,{default:i(()=>[c("Confirm Action: "+u(s(n).status)+" Request",1)]),_:1}),d(s(Z),null,{default:i(()=>[f.value?(l(),r("span",ye," You are about to "+u(s(n).status.toLowerCase())+" this leave request for **"+u(f.value.staff.first_name)+" "+u(f.value.staff.last_name)+"**. ",1)):(l(),r("span",ke," You are about to "+u(s(n).status.toLowerCase())+" a leave request. ",1)),e[16]||(e[16]=c(" You can add an optional note below. "))]),_:1,__:[16]})]),_:1}),o("div",xe,[d(s(Q),{for:"admin_notes"},{default:i(()=>e[17]||(e[17]=[c("Notes (Optional)")])),_:1,__:[17]}),P(o("textarea",{id:"admin_notes","onUpdate:modelValue":e[4]||(e[4]=t=>s(n).admin_notes=t),placeholder:"Reason for denial, etc.",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring-primary dark:border-gray-600 dark:bg-gray-700 dark:text-white"},null,512),[[Y,s(n).admin_notes]]),s(n).errors.admin_notes?(l(),r("div",he,u(s(n).errors.admin_notes),1)):k("",!0)]),d(s(ee),null,{default:i(()=>[d(s(x),{variant:"outline",onClick:e[5]||(e[5]=t=>v.value=!1),disabled:s(n).processing},{default:i(()=>e[18]||(e[18]=[c("Cancel")])),_:1,__:[18]},8,["disabled"]),d(s(x),{onClick:V,disabled:s(n).processing},{default:i(()=>e[19]||(e[19]=[c("Confirm")])),_:1,__:[19]},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})],64))}}),Oe=te(we,[["__scopeId","data-v-b3451fbd"]]);export{Oe as default};
