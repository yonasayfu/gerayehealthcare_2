import{c as A}from"./utils-CBfrqCZ4.js";import{s as i,r as m,E as c,g as d,w as f,X as p,j as l,a2 as S,q as b,_ as q,A as L,o as B,R as E,Q as M,C as $,p as I,b6 as P,K as x,y as k}from"./vendor-BwD25tKZ.js";import{u as h}from"./useForwardExpose-G3tvssmS.js";import{P as y}from"./Primitive-BSXjhaNq.js";import{c as F}from"./createContext-BqFVO7-m.js";import{c as O}from"./format-BcfG6MxF.js";const[R,z]=F("AvatarRoot");var j=i({__name:"AvatarRoot",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(a){return h(),z({imageLoadingStatus:m("idle")}),(e,s)=>(d(),c(l(y),{"as-child":e.asChild,as:e.as},{default:f(()=>[p(e.$slots,"default")]),_:3},8,["as-child","as"]))}}),N=j,D=i({__name:"AvatarFallback",props:{delayMs:{type:Number,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(a){const e=a,s=R();h();const t=m(e.delayMs===void 0);return S(r=>{if(e.delayMs&&q){const n=window.setTimeout(()=>{t.value=!0},e.delayMs);r(()=>{window.clearTimeout(n)})}}),(r,n)=>t.value&&l(s).imageLoadingStatus.value!=="loaded"?(d(),c(l(y),{key:0,"as-child":r.asChild,as:r.as},{default:f(()=>[p(r.$slots,"default")]),_:3},8,["as-child","as"])):b("v-if",!0)}}),T=D;function w(a,e){return a?e?(a.src!==e&&(a.src=e),a.complete&&a.naturalWidth>0?"loaded":"loading"):"error":"idle"}function K(a,{referrerPolicy:e,crossOrigin:s}={}){const t=m(!1),r=m(null),n=L(()=>t.value?(!r.value&&q&&(r.value=new window.Image),r.value):null),v=m(w(n.value,a.value)),_=u=>()=>{t.value&&(v.value=u)};return B(()=>{t.value=!0,S(u=>{const o=n.value;if(!o)return;v.value=w(o,a.value);const g=_("loaded"),C=_("error");o.addEventListener("load",g),o.addEventListener("error",C),e?.value&&(o.referrerPolicy=e.value),typeof s?.value=="string"&&(o.crossOrigin=s.value),u(()=>{o.removeEventListener("load",g),o.removeEventListener("error",C)})})}),E(()=>{t.value=!1}),v}var Q=i({__name:"AvatarImage",props:{src:{type:String,required:!0},referrerPolicy:{type:null,required:!1},crossOrigin:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"img"}},emits:["loadingStatusChange"],setup(a,{emit:e}){const s=a,t=e,{src:r,referrerPolicy:n,crossOrigin:v}=M(s);h();const _=R(),u=K(r,{referrerPolicy:n,crossOrigin:v});return $(u,o=>{t("loadingStatusChange",o),o!=="idle"&&(_.imageLoadingStatus.value=o)},{immediate:!0}),(o,g)=>I((d(),c(l(y),{role:"img","as-child":o.asChild,as:o.as,src:l(r),"referrer-policy":l(n)},{default:f(()=>[p(o.$slots,"default")]),_:3},8,["as-child","as","src","referrer-policy"])),[[P,l(u)==="loaded"]])}}),U=Q;const ee=i({__name:"Avatar",props:{class:{}},setup(a){const e=a;return(s,t)=>(d(),c(l(N),{"data-slot":"avatar",class:x(l(A)("relative flex size-8 shrink-0 overflow-hidden rounded-full",e.class))},{default:f(()=>[p(s.$slots,"default")]),_:3},8,["class"]))}}),ae=i({__name:"AvatarFallback",props:{delayMs:{},asChild:{type:Boolean},as:{},class:{}},setup(a){const e=a,s=L(()=>{const{class:t,...r}=e;return r});return(t,r)=>(d(),c(l(T),k({"data-slot":"avatar-fallback"},s.value,{class:l(A)("bg-muted flex size-full items-center justify-center rounded-full",e.class)}),{default:f(()=>[p(t.$slots,"default")]),_:3},16,["class"]))}}),te=i({__name:"AvatarImage",props:{src:{},referrerPolicy:{},crossOrigin:{},asChild:{type:Boolean},as:{}},setup(a){const e=a;return(s,t)=>(d(),c(l(U),k({"data-slot":"avatar-image"},e,{class:"aspect-square size-full"}),{default:f(()=>[p(s.$slots,"default")]),_:3},16))}}),se=(a,e)=>{const s=a.__vccOpts||a;for(const[t,r]of e)s[t]=r;return s};function W(a){return{all:a=a||new Map,on:function(e,s){var t=a.get(e);t?t.push(s):a.set(e,[s])},off:function(e,s){var t=a.get(e);t&&(s?t.splice(t.indexOf(s)>>>0,1):a.set(e,[]))},emit:function(e,s){var t=a.get(e);t&&t.slice().map(function(r){r(s)}),(t=a.get("*"))&&t.slice().map(function(r){r(e,s)})}}}const X=W(),re=X;function oe(a){return O(a,Date.now())}export{ee as _,te as a,ae as b,se as c,oe as d,re as e};
