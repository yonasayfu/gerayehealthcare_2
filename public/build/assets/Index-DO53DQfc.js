import{s as G,r as x,C as D,D as $,u as W,A as X,f as o,g as n,i as f,j as i,k as Y,w as Z,l as e,q as b,n as w,bQ as tt,bR as et,p as g,B as k,F as c,m as L,t as d,v as T,H as U,K as P,J as st,T as at,x as E}from"./vendor-BwD25tKZ.js";import{_ as rt}from"./AppLayout.vue_vue_type_style_index_0_lang-CvAaBbvn.js";import{d as it}from"./debounce-Cwa4SNQ2.js";import"./charts-DOEJufVb.js";import"./AppSidebarLayout.vue_vue_type_script_setup_true_lang-9XWwQ7Yt.js";import"./utils-CBfrqCZ4.js";import"./createContext-BqFVO7-m.js";import"./useForwardExpose-G3tvssmS.js";import"./constructNow-B9pLeBHj.js";import"./Primitive-BSXjhaNq.js";import"./format-BcfG6MxF.js";import"./VisuallyHidden-C1CaS35V.js";import"./index-CKGAZWQo.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CuMZ7Rul.js";import"./app-Bm08FwIe.js";const lt={class:"space-y-6 p-6"},ot={class:"flex items-center justify-between"},nt={class:"rounded-lg border border-border bg-white dark:bg-gray-900 p-4 shadow-sm"},dt={class:"flex items-center justify-between mb-4"},ut={class:"flex items-center gap-2"},mt={class:"flex items-center gap-3"},ft={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},gt=["value"],bt={class:"overflow-x-auto bg-white dark:bg-gray-900 shadow rounded-lg"},pt={class:"w-full text-left text-sm text-gray-800 dark:text-gray-200"},vt={class:"bg-gray-100 dark:bg-gray-800 text-xs uppercase text-muted-foreground"},ct={class:"px-6 py-4"},yt={class:"px-6 py-4"},xt={class:"px-6 py-4"},wt={class:"px-6 py-4"},kt={class:"px-6 py-4 text-right"},_t={class:"inline-flex items-center justify-end space-x-2"},St=["onClick"],ht=["onClick"],Ct={key:0},At={key:0,class:"flex items-center justify-between mt-4"},$t={class:"text-sm text-muted-foreground"},Lt={class:"flex items-center gap-1"},Tt=["disabled","innerHTML","onClick"],Ut=["disabled"],Vt={class:"px-2 text-sm"},Dt=["disabled"],Mt={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-2xl"},jt={class:"text-lg font-medium leading-6 text-gray-900 dark:text-white mb-4"},Nt=["value"],Ft={key:0,class:"text-xs text-muted-foreground mt-1"},Pt={key:1,class:"text-red-500 text-sm mt-1"},Et={key:0,class:"text-red-500 text-sm mt-1"},Rt={key:0,class:"text-red-500 text-sm mt-1"},Bt={key:0,class:"text-red-500 text-sm mt-1 p-3 bg-red-50 border border-red-200 rounded"},Ht={class:"flex justify-end space-x-3 pt-4"},zt=["disabled"],re=G({__name:"Index",props:{availabilities:{},filters:{},staffList:{}},setup(R){const u=R,B=[{title:"Dashboard",href:route("dashboard")},{title:"Staff Availabilities",href:route("admin.staff-availabilities.index")}],l=x({staff_id:u.filters.staff_id||"",status:u.filters.status||"",start_date:u.filters.start_date||"",end_date:u.filters.end_date||"",sort:u.filters.sort||"start_time",direction:u.filters.direction||"desc",per_page:u.availabilities?.meta?.per_page||10});D(l,it(()=>{$.get(route("admin.staff-availabilities.index"),{...l.value},{preserveState:!0,replace:!0})},300),{deep:!0});function H(a){a&&$.get(a,{},{preserveState:!0,replace:!0})}function M(a){const t=route("admin.staff-availabilities.index"),s=new URLSearchParams({staff_id:String(l.value.staff_id||""),status:String(l.value.status||""),start_date:String(l.value.start_date||""),end_date:String(l.value.end_date||""),sort:String(l.value.sort||""),direction:String(l.value.direction||""),per_page:String(l.value.per_page||10),page:String(a)});$.get(`${t}?${s.toString()}`,{},{preserveState:!0,replace:!0})}function z(){l.value={staff_id:"",status:"",start_date:"",end_date:"",sort:"start_time",direction:"desc",per_page:10}}const p=x(!1),y=x(!1),m=x(u.staffList||[]),_=x(!1),r=W({id:null,staff_id:"",status:"Available",start_time:"",end_time:""}),O=X(()=>{const a=String(r.staff_id||"").length>0,t=!!r.start_time&&!!r.end_time,s=!!r.status,v=r.start_time?new Date(r.start_time).getTime():0,h=r.end_time?new Date(r.end_time).getTime():0,C=t&&h>=v;return a&&C&&s&&!r.processing&&!_.value}),q=()=>{y.value=!1,r.reset(),m.value=u.staffList||[],p.value=!0},I=a=>{y.value=!0,r.id=a.id,r.staff_id=String(a.staff_id),r.status=a.status,r.start_time=a.start_time.slice(0,16),r.end_time=a.end_time.slice(0,16),m.value=u.staffList||[],p.value=!0};async function j(){const a=r.start_time,t=r.end_time;if(!a||!t){m.value=u.staffList||[];return}_.value=!0;try{const s=new URLSearchParams({start_time:a,end_time:t}),v=route("admin.staff-availabilities.availableStaff")+`?${s.toString()}`,h=await fetch(v,{headers:{Accept:"application/json"}});if(!h.ok)throw new Error("Failed to load available staff");const C=await h.json();if(m.value=Array.isArray(C)?C:[],y.value&&r.staff_id){if(!m.value.find(A=>String(A.id)===String(r.staff_id))){const A=(u.staffList||[]).find(Q=>String(Q.id)===String(r.staff_id));A&&(m.value=[A,...m.value])}}else r.staff_id&&!m.value.find(F=>String(F.id)===String(r.staff_id))&&(r.staff_id="")}catch{m.value=u.staffList||[]}finally{_.value=!1}}D(()=>r.start_time,()=>{j()}),D(()=>r.end_time,()=>{j()});const J=()=>{const a=()=>{p.value=!1,r.reset()};y.value?r.put(route("admin.staff-availabilities.update",r.id),{onSuccess:a}):r.post(route("admin.staff-availabilities.store"),{onSuccess:a})};function K(a){confirm("Are you sure you want to delete this availability slot?")&&$.delete(route("admin.staff-availabilities.destroy",a),{preserveScroll:!0})}function S(a){l.value.sort===a?l.value.direction=l.value.direction==="asc"?"desc":"asc":(l.value.sort=a,l.value.direction="asc")}const V=a=>a?`${a.first_name||""} ${a.last_name||""}`.trim():"N/A",N=a=>a?new Date(a).toLocaleString():"N/A";return(a,t)=>(n(),o(c,null,[f(i(Y),{title:"Staff Availabilities"}),f(rt,{breadcrumbs:B},{default:Z(()=>[e("div",lt,[e("div",ot,[t[18]||(t[18]=e("div",null,[e("h1",{class:"text-xl font-semibold text-gray-800 dark:text-white"},"Staff Availability Records"),e("p",{class:"text-sm text-muted-foreground"},"Review and manage all staff availability slots.")],-1)),e("button",{onClick:q,class:"inline-flex items-center gap-2 bg-cyan-600 hover:bg-cyan-700 text-white font-semibold px-4 py-2 rounded-lg text-sm shadow-md"},[f(i(tt),{class:"h-4 w-4"}),t[17]||(t[17]=w(" Add New Slot ",-1))])]),e("div",nt,[e("div",dt,[e("div",ut,[f(i(et),{class:"h-5 w-5 text-muted-foreground"}),t[19]||(t[19]=e("h3",{class:"text-lg font-semibold"},"Filters",-1))]),e("div",mt,[t[21]||(t[21]=e("label",{class:"text-sm text-muted-foreground"},"Per page",-1)),g(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>l.value.per_page=s),class:"border rounded px-2 py-1 text-sm"},[...t[20]||(t[20]=[e("option",{value:5},"5",-1),e("option",{value:10},"10",-1),e("option",{value:25},"25",-1),e("option",{value:50},"50",-1)])],512),[[k,l.value.per_page,void 0,{number:!0}]]),e("button",{onClick:z,type:"button",class:"px-3 py-1.5 border rounded text-sm hover:bg-gray-100"},"Reset Filters")])]),e("div",ft,[e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Staff Member",-1)),g(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>l.value.staff_id=s),class:"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5"},[t[22]||(t[22]=e("option",{value:""},"All Staff",-1)),(n(!0),o(c,null,L(a.staffList,s=>(n(),o("option",{key:s.id,value:String(s.id)},d(V(s)),9,gt))),128))],512),[[k,l.value.staff_id]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Status",-1)),g(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>l.value.status=s),class:"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5"},[...t[24]||(t[24]=[e("option",{value:""},"All Statuses",-1),e("option",{value:"Available"},"Available",-1),e("option",{value:"Unavailable"},"Unavailable",-1)])],512),[[k,l.value.status]])]),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"From Date",-1)),g(e("input",{type:"date","onUpdate:modelValue":t[3]||(t[3]=s=>l.value.start_date=s),class:"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5"},null,512),[[T,l.value.start_date]])]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"To Date",-1)),g(e("input",{type:"date","onUpdate:modelValue":t[4]||(t[4]=s=>l.value.end_date=s),class:"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5"},null,512),[[T,l.value.end_date]])])])]),e("div",bt,[e("table",pt,[e("thead",vt,[e("tr",null,[e("th",{class:"px-6 py-3 cursor-pointer",onClick:t[5]||(t[5]=s=>S("staff_id"))},[t[28]||(t[28]=w(" Staff Member ",-1)),f(i(U),{class:"inline w-4 h-4 ml-1"})]),e("th",{class:"px-6 py-3 cursor-pointer",onClick:t[6]||(t[6]=s=>S("status"))},[t[29]||(t[29]=w(" Status ",-1)),f(i(U),{class:"inline w-4 h-4 ml-1"})]),e("th",{class:"px-6 py-3 cursor-pointer",onClick:t[7]||(t[7]=s=>S("start_time"))},[t[30]||(t[30]=w(" Start Time ",-1)),f(i(U),{class:"inline w-4 h-4 ml-1"})]),e("th",{class:"px-6 py-3 cursor-pointer",onClick:t[8]||(t[8]=s=>S("end_time"))},[t[31]||(t[31]=w(" End Time ",-1)),f(i(U),{class:"inline w-4 h-4 ml-1"})]),t[32]||(t[32]=e("th",{class:"px-6 py-3 text-right"},"Actions",-1))])]),e("tbody",null,[(n(!0),o(c,null,L(a.availabilities.data,s=>(n(),o("tr",{key:s.id,class:"border-b dark:border-gray-700"},[e("td",ct,d(V(s.staff)),1),e("td",yt,[e("span",{class:P(["px-2 py-1 rounded-full text-xs font-semibold",s.status==="Available"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},d(s.status),3)]),e("td",xt,d(N(s.start_time)),1),e("td",wt,d(N(s.end_time)),1),e("td",kt,[e("div",_t,[e("button",{onClick:v=>I(s),class:"inline-flex items-center justify-center w-8 h-8 rounded-full hover:bg-blue-100",title:"Edit Slot"},[f(i(st),{class:"w-4 h-4 text-blue-600"})],8,St),e("button",{onClick:v=>K(s.id),class:"inline-flex items-center justify-center w-8 h-8 rounded-full hover:bg-red-100",title:"Delete Slot"},[f(i(at),{class:"w-4 h-4 text-red-600"})],8,ht)])])]))),128)),a.availabilities.data.length===0?(n(),o("tr",Ct,[...t[33]||(t[33]=[e("td",{colspan:"5",class:"text-center px-6 py-4 text-gray-400"},"No records found.",-1)])])):b("",!0)])])]),a.availabilities&&a.availabilities.meta?(n(),o("div",At,[e("div",$t," Showing "+d(a.availabilities.meta&&a.availabilities.meta.from?a.availabilities.meta.from:0)+" to "+d(a.availabilities.meta&&a.availabilities.meta.to?a.availabilities.meta.to:0)+" of "+d(a.availabilities.meta&&a.availabilities.meta.total?a.availabilities.meta.total:0)+" results ",1),e("div",Lt,[a.availabilities.links&&a.availabilities.links.length?(n(!0),o(c,{key:0},L(a.availabilities.links,s=>(n(),o("button",{key:(s.label||"")+String(!!s.active),disabled:!s.url,innerHTML:s.label,onClick:v=>H(s.url),class:P(["px-3 py-1 border rounded text-sm",[s.active?"bg-cyan-600 text-white border-cyan-600":"hover:bg-gray-100",s.url?"cursor-pointer":"opacity-50 cursor-not-allowed"]])},null,10,Tt))),128)):(n(),o(c,{key:1},[e("button",{class:"px-3 py-1 border rounded text-sm hover:bg-gray-100",disabled:a.availabilities.meta.current_page<=1,onClick:t[9]||(t[9]=s=>M(a.availabilities.meta.current_page-1))},"Previous",8,Ut),e("span",Vt,"Page "+d(a.availabilities.meta.current_page)+" of "+d(a.availabilities.meta.last_page),1),e("button",{class:"px-3 py-1 border rounded text-sm hover:bg-gray-100",disabled:a.availabilities.meta.current_page>=a.availabilities.meta.last_page,onClick:t[10]||(t[10]=s=>M(a.availabilities.meta.current_page+1))},"Next",8,Dt)],64))])])):b("",!0)]),p.value?(n(),o("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center",style:{"background-color":"rgba(0, 0, 0, 0.5)"},onClick:t[16]||(t[16]=E(s=>p.value=!1,["self"]))},[e("div",Mt,[e("h3",jt,d(y.value?"Edit":"Create")+" Availability Slot ",1),e("form",{onSubmit:E(J,["prevent"]),class:"space-y-4"},[e("div",null,[t[35]||(t[35]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Staff Member",-1)),g(e("select",{"onUpdate:modelValue":t[11]||(t[11]=s=>i(r).staff_id=s),class:"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5"},[t[34]||(t[34]=e("option",{disabled:"",value:""},"Please select a staff member",-1)),(n(!0),o(c,null,L(m.value,s=>(n(),o("option",{key:s.id,value:String(s.id)},d(V(s)),9,Nt))),128))],512),[[k,i(r).staff_id]]),_.value?(n(),o("div",Ft,"Loading available staffâ€¦")):b("",!0),i(r).errors.staff_id?(n(),o("div",Pt,d(i(r).errors.staff_id),1)):b("",!0)]),e("div",null,[t[37]||(t[37]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Status",-1)),g(e("select",{"onUpdate:modelValue":t[12]||(t[12]=s=>i(r).status=s),class:"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5"},[...t[36]||(t[36]=[e("option",null,"Available",-1),e("option",null,"Unavailable",-1)])],512),[[k,i(r).status]])]),e("div",null,[t[38]||(t[38]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Start Time",-1)),g(e("input",{type:"datetime-local",step:"1","onUpdate:modelValue":t[13]||(t[13]=s=>i(r).start_time=s),class:"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5"},null,512),[[T,i(r).start_time]]),i(r).errors.start_time?(n(),o("div",Et,d(i(r).errors.start_time),1)):b("",!0)]),e("div",null,[t[39]||(t[39]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"End Time",-1)),g(e("input",{type:"datetime-local",step:"1","onUpdate:modelValue":t[14]||(t[14]=s=>i(r).end_time=s),class:"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5"},null,512),[[T,i(r).end_time]]),i(r).errors.end_time?(n(),o("div",Rt,d(i(r).errors.end_time),1)):b("",!0)]),i(r).errors.error?(n(),o("div",Bt,d(i(r).errors.error),1)):b("",!0),e("div",Ht,[e("button",{onClick:t[15]||(t[15]=s=>p.value=!1),type:"button",class:"px-4 py-2 border rounded-md text-gray-700 hover:bg-gray-100"},"Cancel"),e("button",{type:"submit",disabled:!O.value,class:"px-4 py-2 bg-cyan-600 text-white rounded-md disabled:opacity-50 hover:bg-cyan-700"},d(i(r).processing?"Saving...":"Save Slot"),9,zt)])],32)])])):b("",!0)]),_:1})],64))}});export{re as default};
