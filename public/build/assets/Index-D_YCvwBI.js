import{d as S,k as C,x as D,l as $,f as E,c as n,o,a as c,u as i,g as B,w as N,b as t,q as u,i as V,v as F,F as h,r as U,t as l,s as W,I as A,p as L,_ as T}from"./app-CKJLXAx0.js";import{C as I,p as j,a as q,b as M,B as O,c as R,L as H,d as z}from"./index-nbnDiP2R.js";import{_ as G}from"./Pagination.vue_vue_type_script_setup_true_lang-CyfsrxX9.js";const J={class:"p-6 space-y-6"},K={class:"flex flex-col md:flex-row justify-between items-center gap-4 mb-4"},Q={class:"flex items-center gap-2"},X={class:"overflow-x-auto bg-white dark:bg-gray-900 shadow rounded-lg"},Y={class:"w-full text-left text-sm text-gray-800 dark:text-gray-200"},Z={class:"px-6 py-4 font-medium"},tt={class:"px-6 py-4 text-center"},et={class:"px-6 py-4 text-center"},st={class:"px-6 py-4 text-center"},at={class:"px-6 py-4 font-semibold text-green-600"},ot={class:"px-6 py-4 text-right"},rt=["onClick","disabled"],nt={key:1,class:"text-xs text-gray-400"},it={key:0},lt={class:"flex justify-between items-center mt-6"},dt={key:0,class:"p-4 bg-white dark:bg-gray-900 rounded-lg shadow h-80"},gt=S({__name:"Index",props:{staffWithEarnings:{},performanceData:{}},setup(b){I.register(j,q,M,O,R,H);const m=b,v=[{title:"Dashboard",href:route("dashboard")},{title:"Staff Payouts",href:route("admin.staff-payouts.index")}],d=C(10),r=D({staff_id:null,per_page:d.value});$(d,s=>{r.per_page=s,r.get(route("admin.staff-payouts.index"),{preserveState:!0})});const k=(s,e,p)=>{confirm(`Are you sure you want to process a payout of ${g(p)} for ${e}?`)&&r.transform(()=>({staff_id:s})).post(route("admin.staff-payouts.store"),{preserveScroll:!0})},g=s=>{const e=parseFloat(s||"0");return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e)},w=E(()=>({labels:m.performanceData.map(s=>`${s.first_name} ${s.last_name}`),datasets:[{label:"Total Paid Earnings ($)",backgroundColor:"#16a34a",borderColor:"#16a34a",data:m.performanceData.map(s=>parseFloat(s.payouts_sum_total_amount||"0"))}]})),P={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:"Staff Performance: Total Earnings Paid Out"}}};return(s,e)=>(o(),n(h,null,[c(i(B),{title:"Staff Payouts"}),c(T,{breadcrumbs:v},{default:N(()=>{var p,f,y,x,_;return[t("div",J,[e[6]||(e[6]=t("div",{class:"rounded-lg bg-muted/40 p-4 shadow-sm"},[t("h1",{class:"text-xl font-semibold text-gray-800 dark:text-white"},"Staff Payouts & Performance"),t("p",{class:"text-sm text-muted-foreground"},"Review earnings, performance metrics, and process payments for staff.")],-1)),t("div",K,[e[3]||(e[3]=t("div",{class:"relative w-full md:w-1/3"},null,-1)),t("div",Q,[e[2]||(e[2]=t("label",{for:"per-page",class:"text-sm text-gray-600 dark:text-gray-400"},"Per Page:",-1)),V(t("select",{id:"per-page","onUpdate:modelValue":e[0]||(e[0]=a=>d.value=a),class:"form-select rounded-md shadow-sm text-sm"},e[1]||(e[1]=[t("option",{value:"10"},"10",-1),t("option",{value:"20"},"20",-1),t("option",{value:"50"},"50",-1),t("option",{value:"100"},"100",-1)]),512),[[F,d.value]])])]),t("div",X,[t("table",Y,[e[5]||(e[5]=t("thead",{class:"bg-gray-100 dark:bg-gray-800 text-xs uppercase text-muted-foreground"},[t("tr",null,[t("th",{class:"px-6 py-3"},"Staff Member"),t("th",{class:"px-6 py-3 text-center"},"Unpaid Visits"),t("th",{class:"px-6 py-3 text-center"},"Patients Visited"),t("th",{class:"px-6 py-3 text-center"},"Hours Logged"),t("th",{class:"px-6 py-3"},"Total Unpaid Amount"),t("th",{class:"px-6 py-3 text-right"},"Actions")])],-1)),t("tbody",null,[(o(!0),n(h,null,U((p=s.staffWithEarnings)==null?void 0:p.data,a=>(o(),n("tr",{key:a.id,class:"border-b dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800"},[t("td",Z,l(a.first_name)+" "+l(a.last_name),1),t("td",tt,l(a.unpaid_visits_count),1),t("td",et,l(a.unique_patients_count),1),t("td",st,l(a.total_hours_logged),1),t("td",at,l(g(a.total_unpaid_cost)),1),t("td",ot,[a.unpaid_visits_count>0?(o(),n("button",{key:0,onClick:pt=>k(a.id,`${a.first_name} ${a.last_name}`,a.total_unpaid_cost),disabled:i(r).processing&&i(r).staff_id===a.id,class:"inline-flex items-center gap-2 text-sm px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-md transition disabled:opacity-50"},[c(i(A),{class:"h-4 w-4"}),W(" "+l(i(r).processing&&i(r).staff_id===a.id?"Processing...":"Process Payout"),1)],8,rt)):(o(),n("span",nt,"No pending payments"))])]))),128)),((y=(f=s.staffWithEarnings)==null?void 0:f.data)==null?void 0:y.length)===0?(o(),n("tr",it,e[4]||(e[4]=[t("td",{colspan:"6",class:"text-center px-6 py-4 text-gray-400"},"No staff with unpaid visits found.",-1)]))):u("",!0)])])]),t("div",lt,[((_=(x=s.staffWithEarnings)==null?void 0:x.data)==null?void 0:_.length)>0?(o(),L(G,{key:0,links:s.staffWithEarnings.links},null,8,["links"])):u("",!0)]),s.performanceData.length>0?(o(),n("div",dt,[c(i(z),{data:w.value,options:P},null,8,["data"])])):u("",!0)])]}),_:1})],64))}});export{gt as default};
