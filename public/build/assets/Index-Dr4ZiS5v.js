import{s as C,A as I,r as h,f as l,g as n,i as c,j as m,k as V,w as g,l as t,q as d,t as i,F as x,m as D,K as E,E as N,z as M,n as P,dI as A,D as L}from"./vendor-BwD25tKZ.js";import{_ as O}from"./AppLayout.vue_vue_type_style_index_0_lang-CvAaBbvn.js";import{f as B}from"./format-BcfG6MxF.js";import"./charts-DOEJufVb.js";import"./AppSidebarLayout.vue_vue_type_script_setup_true_lang-9XWwQ7Yt.js";import"./utils-CBfrqCZ4.js";import"./createContext-BqFVO7-m.js";import"./useForwardExpose-G3tvssmS.js";import"./constructNow-B9pLeBHj.js";import"./Primitive-BSXjhaNq.js";import"./VisuallyHidden-C1CaS35V.js";import"./index-CKGAZWQo.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CuMZ7Rul.js";import"./debounce-Cwa4SNQ2.js";import"./app-Bm08FwIe.js";const F={class:"p-6 space-y-6"},T={key:0,class:"rounded-md bg-red-50 p-4"},S={class:"flex"},$={class:"ml-3"},j={class:"mt-2 text-sm text-red-700"},Y={class:"space-y-4"},q={key:0,class:"text-center text-gray-500 py-8"},z={class:"flex justify-between items-start"},R={class:"font-semibold text-primary"},U={class:"text-sm text-muted-foreground"},G={class:"border-t pt-3 flex justify-end"},K=["onClick","disabled"],H=["onClick","disabled"],ue=C({__name:"Index",props:{visits:{}},setup(b){const y=b,p=I(()=>y.visits?.data||[]),_=[{title:"Dashboard",href:route("dashboard")},{title:"My Visits",href:route("staff.my-visits.index")}],s=h(null),o=h(null);function f(r,a){if(s.value=r.id,o.value=null,!navigator.geolocation){o.value="Geolocation is not supported by your browser.",s.value=null;return}navigator.geolocation.getCurrentPosition(e=>{const{latitude:u,longitude:k}=e.coords,w=route(`staff.my-visits.${a}`,r.id);L.post(w,{latitude:u,longitude:k},{preserveScroll:!0,onFinish:()=>{s.value=null}})},e=>{switch(e.code){case e.PERMISSION_DENIED:o.value="You must allow location access to check in/out.";break;case e.POSITION_UNAVAILABLE:o.value="Location information is unavailable.";break;case e.TIMEOUT:o.value="The request to get user location timed out.";break;default:o.value="An unknown error occurred.";break}s.value=null})}const v=r=>r?B(new Date(r),"MMM dd, yyyy, hh:mm a"):"N/A";return(r,a)=>(n(),l(x,null,[c(m(V),{title:"My Visits"}),c(O,{breadcrumbs:_},{default:g(()=>[t("div",F,[a[2]||(a[2]=t("div",{class:"rounded-lg bg-muted/40 p-4 shadow-sm"},[t("h1",{class:"text-xl font-semibold text-gray-800 dark:text-white"},"My Daily Visits"),t("p",{class:"text-sm text-muted-foreground"},"Your scheduled visits for today and the future.")],-1)),o.value?(n(),l("div",T,[t("div",S,[t("div",$,[a[0]||(a[0]=t("h3",{class:"text-sm font-medium text-red-800"},"Location Error",-1)),t("div",j,[t("p",null,i(o.value),1)])])])])):d("",!0),t("div",Y,[p.value.length===0?(n(),l("div",q," You have no assigned visits. ")):d("",!0),(n(!0),l(x,null,D(p.value,e=>(n(),l("div",{key:e.id,class:"rounded-lg border bg-white dark:bg-background p-4 shadow-sm space-y-3"},[t("div",z,[t("div",null,[t("p",R,i(e.patient.full_name),1),t("p",U,i(v(e.scheduled_at)),1)]),t("span",{class:E({"px-2 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full":!0,"bg-yellow-100 text-yellow-800":e.status==="Pending","bg-blue-100 text-blue-800":e.status==="In Progress","bg-green-100 text-green-800":e.status==="Completed","bg-red-100 text-red-800":e.status==="Cancelled"})},i(e.status),3)]),t("div",G,[e.status==="Pending"?(n(),l("button",{key:0,onClick:u=>f(e,"check-in"),disabled:s.value===e.id,class:"inline-flex items-center px-4 py-2 bg-cyan-600 hover:bg-cyan-700 disabled:opacity-50 text-white rounded-md text-sm font-medium transition"},i(s.value===e.id?"Checking In...":"Check In"),9,K)):d("",!0),e.status==="In Progress"?(n(),l("button",{key:1,onClick:u=>f(e,"check-out"),disabled:s.value===e.id,class:"inline-flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 disabled:opacity-50 text-white rounded-md text-sm font-medium transition"},i(s.value===e.id?"Checking Out...":"Check Out"),9,H)):d("",!0),e.status==="Completed"&&!e.service_id?(n(),N(m(M),{key:2,href:r.route("staff.my-visits.report.create",{visit:e.id}),class:"inline-flex items-center gap-2 px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-md text-sm font-medium transition"},{default:g(()=>[c(m(A),{class:"h-4 w-4"}),a[1]||(a[1]=P(" File Visit Report ",-1))]),_:2},1032,["href"])):d("",!0)])]))),128))])])]),_:1})],64))}});export{ue as default};
