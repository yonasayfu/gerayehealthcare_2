import{s as B,r as d,u as L,C as k,D as _,A as N,V as w,f as n,g as r,i as u,j as x,k as q,w as C,l as t,q as m,K as A,t as o,F as P,m as W,E as S,n as j,aK as M,bH as U}from"./vendor-BwD25tKZ.js";import{_ as G}from"./AppLayout.vue_vue_type_style_index_0_lang-CvAaBbvn.js";import{C as H,p as O,a as z,b as I,c as K,d as Q,L as R}from"./charts-DOEJufVb.js";import{_ as J}from"./Pagination.vue_vue_type_script_setup_true_lang-DAC70Nby.js";import"./AppSidebarLayout.vue_vue_type_script_setup_true_lang-9XWwQ7Yt.js";import"./utils-CBfrqCZ4.js";import"./createContext-BqFVO7-m.js";import"./useForwardExpose-G3tvssmS.js";import"./constructNow-B9pLeBHj.js";import"./Primitive-BSXjhaNq.js";import"./format-BcfG6MxF.js";import"./VisuallyHidden-C1CaS35V.js";import"./index-CKGAZWQo.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CuMZ7Rul.js";import"./debounce-Cwa4SNQ2.js";import"./app-Bm08FwIe.js";const X={class:"p-6 space-y-6"},Y={class:"liquidGlass-wrapper print:hidden"},Z={class:"liquidGlass-content flex items-center justify-between p-4 gap-4"},tt={class:"flex items-center gap-2 print:hidden"},et={class:"overflow-x-auto bg-white dark:bg-gray-900 shadow rounded-lg"},st={class:"w-full text-left text-sm text-gray-800 dark:text-gray-200"},at={class:"px-6 py-4 font-medium"},rt={class:"px-6 py-4 text-center"},nt={class:"px-6 py-4 text-center"},ot={class:"px-6 py-4 text-center"},it={class:"px-6 py-4 font-semibold text-green-600"},lt={class:"px-6 py-4 text-right"},dt=["onClick","disabled"],ut={key:0,class:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},pt={key:1,class:"text-xs text-gray-400"},ct={key:0},mt={class:"flex justify-between items-center mt-6"},gt={key:1,class:"p-4 bg-white dark:bg-gray-900 rounded-lg shadow h-80"},Tt=B({__name:"Index",props:{staffWithEarnings:{},performanceData:{}},setup(E){H.register(O,z,I,K,Q,R);const v=E,$=[{title:"Dashboard",href:route("dashboard")},{title:"Staff Payouts",href:route("admin.staff-payouts.index")}],p=d(5),g=d(""),D=L({staff_id:null,per_page:p.value}),i=d(null),l=d(null),c=d(null);let y=null;k(g,e=>{y&&clearTimeout(y),y=setTimeout(()=>{_.get(route("admin.staff-payouts.index"),{per_page:p.value,search:e},{preserveState:!0,replace:!0})},300)}),k(p,e=>{_.get(route("admin.staff-payouts.index"),{per_page:e,search:g.value},{preserveState:!0,replace:!0})});const V=(e,s,f)=>{confirm(`Process payout of ${b(f)} for ${s}?`)&&(l.value=null,c.value=null,i.value=e,D.transform(()=>({staff_id:e})).post(route("admin.staff-payouts.store"),{preserveScroll:!0,onSuccess:()=>{l.value=`Payout processed successfully for ${s}.`,c.value="success",_.get(route("admin.staff-payouts.index"),{per_page:p.value,search:g.value},{preserveState:!0,replace:!0})},onError:h=>{l.value=Object.values(h)[0]??"Failed to process payout.",c.value="error"},onFinish:()=>{i.value=null}}))},b=e=>{const s=parseFloat(e||"0");return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s)},F=N(()=>({labels:v.performanceData.map(e=>`${e.first_name} ${e.last_name}`),datasets:[{label:"Total Paid Earnings ($)",backgroundColor:"#16a34a",borderColor:"#16a34a",data:v.performanceData.map(e=>parseFloat(e.payouts_sum_total_amount||"0"))}]})),T={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:"Staff Performance: Total Earnings Paid Out"}}};return(e,s)=>{const f=w("Link"),h=w("Printer");return r(),n(P,null,[u(x(q),{title:"Staff Payouts"}),u(G,{breadcrumbs:$},{default:C(()=>[t("div",X,[t("div",Y,[s[4]||(s[4]=t("div",{class:"liquidGlass-inner-shine","aria-hidden":"true"},null,-1)),t("div",Z,[s[3]||(s[3]=t("div",{class:"flex items-center gap-4"},[t("div",{class:"print:hidden"},[t("h1",{class:"text-2xl font-semibold text-gray-900 dark:text-gray-100"},"Staff Payouts"),t("p",{class:"text-sm text-gray-600 dark:text-gray-300"},"Manage staff payouts")])],-1)),t("div",tt,[u(f,{href:e.route("admin.staff-payouts.create"),class:"btn-glass"},{default:C(()=>[...s[1]||(s[1]=[t("span",null,"Add Staff Payout",-1)])]),_:1},8,["href"]),t("button",{onClick:s[0]||(s[0]=(...a)=>e.printCurrentView&&e.printCurrentView(...a)),class:"btn-glass btn-glass-sm"},[u(h,{class:"icon"}),s[2]||(s[2]=t("span",{class:"hidden sm:inline"},"Print Current",-1))])])])]),l.value?(r(),n("div",{key:0,class:A(["rounded-md p-3 text-sm",c.value==="success"?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"])},o(l.value),3)):m("",!0),t("div",et,[t("table",st,[s[7]||(s[7]=t("thead",{class:"bg-gray-100 dark:bg-gray-800 text-xs uppercase text-muted-foreground"},[t("tr",null,[t("th",{class:"px-6 py-3"},"Staff Member"),t("th",{class:"px-6 py-3 text-center"},"Unpaid Visits"),t("th",{class:"px-6 py-3 text-center"},"Patients Visited"),t("th",{class:"px-6 py-3 text-center"},"Hours Logged"),t("th",{class:"px-6 py-3"},"Total Unpaid Amount"),t("th",{class:"px-6 py-3 text-right"},"Actions")])],-1)),t("tbody",null,[(r(!0),n(P,null,W(e.staffWithEarnings?.data,a=>(r(),n("tr",{key:a.id,class:"border-b dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800"},[t("td",at,o(a.first_name)+" "+o(a.last_name),1),t("td",rt,o(a.unpaid_visits_count),1),t("td",nt,o(a.unique_patients_count),1),t("td",ot,o(a.total_hours_logged),1),t("td",it,o(b(a.total_unpaid_cost)),1),t("td",lt,[a.unpaid_visits_count>0?(r(),n("button",{key:0,onClick:yt=>V(a.id,`${a.first_name} ${a.last_name}`,a.total_unpaid_cost),disabled:i.value===a.id,class:"inline-flex items-center gap-2 text-sm px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-md transition disabled:opacity-50"},[i.value===a.id?(r(),n("svg",ut,[...s[5]||(s[5]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"},null,-1)])])):(r(),S(x(M),{key:1,class:"h-4 w-4"})),j(" "+o(i.value===a.id?"Processing...":"Process Payout"),1)],8,dt)):(r(),n("span",pt,"No pending payments"))])]))),128)),e.staffWithEarnings?.data?.length===0?(r(),n("tr",ct,[...s[6]||(s[6]=[t("td",{colspan:"6",class:"text-center px-6 py-4 text-gray-400"},"No staff with unpaid visits found.",-1)])])):m("",!0)])])]),t("div",mt,[e.staffWithEarnings?.data?.length>0?(r(),S(J,{key:0,links:e.staffWithEarnings.links},null,8,["links"])):m("",!0)]),e.performanceData.length>0?(r(),n("div",gt,[u(x(U),{data:F.value,options:T},null,8,["data"])])):m("",!0)])]),_:1})],64)}}});export{Tt as default};
