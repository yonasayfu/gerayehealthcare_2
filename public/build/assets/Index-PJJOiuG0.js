import{s as F,r as k,C as j,D as I,u as O,V as Y,f as d,g as r,i as n,j as s,k as K,w as i,l as t,p as R,v as B,B as L,n as m,q as f,F as y,E as v,bC as A,bD as V,m as G,t as u,K as H}from"./vendor-BwD25tKZ.js";import{_ as J}from"./AppLayout.vue_vue_type_style_index_0_lang-CvAaBbvn.js";import{_ as x}from"./index-CKGAZWQo.js";import{_ as U}from"./Label.vue_vue_type_script_setup_true_lang-DzVq0Sz6.js";import{_ as Q,a as W,b as X,c as Z,d as ee,e as te}from"./DialogTitle.vue_vue_type_script_setup_true_lang-CioSWVMg.js";import{c as se}from"./constructNow-B9pLeBHj.js";import"./charts-DOEJufVb.js";import"./AppSidebarLayout.vue_vue_type_script_setup_true_lang-9XWwQ7Yt.js";import"./utils-CBfrqCZ4.js";import"./createContext-BqFVO7-m.js";import"./useForwardExpose-G3tvssmS.js";import"./VisuallyHidden-C1CaS35V.js";import"./Primitive-BSXjhaNq.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CuMZ7Rul.js";import"./debounce-Cwa4SNQ2.js";import"./app-Bm08FwIe.js";import"./format-BcfG6MxF.js";const ae={class:"rounded-xl bg-white shadow-sm dark:border-sidebar-border dark:bg-background"},oe={class:"p-5"},re={class:"flex flex-col md:flex-row justify-between items-center gap-4 mb-4"},le={class:"relative w-full md:w-1/3"},ne={class:"flex items-center gap-2"},ie={key:0,class:"overflow-x-auto"},de={class:"min-w-full text-left text-sm"},ue={class:"flex items-center"},me={class:"flex items-center"},pe={class:"flex items-center"},fe={class:"p-2"},ve={class:"p-2"},ce={class:"p-2"},ge={class:"p-2"},_e={class:"p-2 text-right"},be={class:"flex justify-end gap-2"},ke={key:1,class:"py-10 text-center text-muted-foreground"},ye={class:"flex justify-between items-center mt-4"},xe={key:0},we={key:1},Ce={class:"py-4"},he={class:"mb-4"},Re={key:0,class:"text-red-500 text-xs mt-1"},De={key:0,class:"text-red-500 text-xs mt-1"},Se=F({__name:"Index",props:{leaveRequests:{},filters:{}},setup(E){const w=E,M=[{title:"Dashboard",href:route("dashboard")},{title:"Leave Requests",href:route("admin.leave-requests.index")}],C=k(w.filters.search||""),c=k(w.filters.sort_by),p=k(w.filters.sort_order),g=k(Number(w.filters.per_page)||5);let D=null;j(C,a=>{D&&clearTimeout(D),D=setTimeout(()=>{S()},300)}),j(g,a=>{const e=Number(a)||5;e!==g.value&&(g.value=e),S({preserveScroll:!0})});const S=a=>{I.get(route("admin.leave-requests.index"),{search:C.value,sort_by:c.value,sort_order:p.value,per_page:g.value},{preserveState:a?.preserveState??!0,preserveScroll:a?.preserveScroll??!0,only:["leaveRequests","filters"]})},$=a=>{const h={staff_member:"staff_first_name",dates_requested:"start_date",status:"status"}[a]||a;c.value===h?p.value=p.value==="asc"?"desc":"asc":(c.value=h,p.value="asc"),S()},_=k(!1),b=k(null),l=O({status:"",admin_notes:""}),q=(a,e)=>{b.value=a,l.status=e??a.status,l.admin_notes=a.admin_notes||"",_.value=!0},T=()=>{if(!b.value){console.error("ERROR: No selectedRequest.value. Dialog should not have been confirmed without one."),_.value=!1;return}l.put(route("admin.leave-requests.update",b.value.id),{preserveScroll:!0,onSuccess:a=>{_.value=!1,l.reset()},onError:a=>{console.error("--- Inertia PUT request FAILED! ---"),console.error("Errors:",a),a&&Object.keys(a).length>0?alert("Validation failed: "+Object.values(a).join(`
`)):alert("An unknown error occurred during update. Check console and network tab.")},onFinish:()=>{}})},N=a=>a?new Date(a).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"}):"N/A",z=a=>{switch(a){case"Approved":return"bg-green-100 text-green-800";case"Denied":return"bg-red-100 text-red-800";default:return"bg-yellow-100 text-yellow-800"}};return(a,e)=>{const h=Y("Pagination");return r(),d(y,null,[n(s(K),{title:"Leave Requests Management"}),n(J,{breadcrumbs:M},{default:i(()=>[t("div",ae,[e[21]||(e[21]=t("div",{class:"border-b p-5"},[t("h2",{class:"text-lg font-semibold"},"Staff Leave Requests"),t("p",{class:"mt-1 text-sm text-muted-foreground"},"Review and manage all time-off requests from staff.")],-1)),t("div",oe,[t("div",re,[t("div",le,[R(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>C.value=o),placeholder:"Search by staff name, reason, or status...",class:"form-input w-full rounded-md border border-gray-300 pl-10 pr-4 py-2 text-sm shadow-sm focus:ring-2 focus:ring-indigo-500 focus:outline-none dark:bg-gray-900 dark:text-gray-100"},null,512),[[B,C.value]]),e[9]||(e[9]=t("svg",{class:"absolute left-3 top-1/2 -translate-y-1/2 size-4 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35m0 0A7.5 7.5 0 1012 19.5a7.5 7.5 0 004.65-1.85z"})],-1))]),t("div",ne,[e[11]||(e[11]=t("label",{for:"per-page",class:"text-sm text-gray-600 dark:text-gray-400"},"Per Page:",-1)),R(t("select",{id:"per-page","onUpdate:modelValue":e[1]||(e[1]=o=>g.value=o),class:"rounded-md border-gray-300 bg-white text-gray-900 sm:text-sm px-2 py-1 dark:bg-gray-800 dark:text-gray-100 dark:border-gray-700"},[...e[10]||(e[10]=[t("option",{value:"5"},"5",-1),t("option",{value:"10"},"10",-1),t("option",{value:"20"},"20",-1),t("option",{value:"50"},"50",-1),t("option",{value:"100"},"100",-1)])],512),[[L,g.value]])])]),a.leaveRequests.data.length>0?(r(),d("div",ie,[t("table",de,[t("thead",null,[t("tr",null,[t("th",{class:"p-2 cursor-pointer select-none",onClick:e[2]||(e[2]=o=>$("staff_member"))},[t("div",ue,[e[12]||(e[12]=m(" Staff Member ",-1)),c.value==="staff_first_name"?(r(),d(y,{key:0},[p.value==="asc"?(r(),v(s(A),{key:0,class:"h-4 w-4 ml-1"})):(r(),v(s(V),{key:1,class:"h-4 w-4 ml-1"}))],64)):f("",!0)])]),t("th",{class:"p-2 cursor-pointer select-none",onClick:e[3]||(e[3]=o=>$("dates_requested"))},[t("div",me,[e[13]||(e[13]=m(" Dates Requested ",-1)),c.value==="start_date"?(r(),d(y,{key:0},[p.value==="asc"?(r(),v(s(A),{key:0,class:"h-4 w-4 ml-1"})):(r(),v(s(V),{key:1,class:"h-4 w-4 ml-1"}))],64)):f("",!0)])]),e[15]||(e[15]=t("th",{class:"p-2"},"Reason",-1)),t("th",{class:"p-2 cursor-pointer select-none",onClick:e[4]||(e[4]=o=>$("status"))},[t("div",pe,[e[14]||(e[14]=m(" Status ",-1)),c.value==="status"?(r(),d(y,{key:0},[p.value==="asc"?(r(),v(s(A),{key:0,class:"h-4 w-4 ml-1"})):(r(),v(s(V),{key:1,class:"h-4 w-4 ml-1"}))],64)):f("",!0)])]),e[16]||(e[16]=t("th",{class:"p-2 text-right"},"Actions",-1))])]),t("tbody",null,[(r(!0),d(y,null,G(a.leaveRequests.data,o=>(r(),d("tr",{key:o.id,class:"border-t"},[t("td",fe,u(o.staff.first_name)+" "+u(o.staff.last_name),1),t("td",ve,u(N(o.start_date))+" - "+u(N(o.end_date)),1),t("td",ce,u(o.reason||"N/A"),1),t("td",ge,[t("span",{class:H(["rounded-full px-2 py-1 text-xs font-medium",z(o.status)])},u(o.status),3)]),t("td",_e,[t("div",be,[o.status==="Pending"?(r(),d(y,{key:0},[n(s(x),{variant:"outline",size:"sm",onClick:P=>q(o,"Approved")},{default:i(()=>[...e[17]||(e[17]=[m("Approve",-1)])]),_:2},1032,["onClick"]),n(s(x),{variant:"destructive",size:"sm",onClick:P=>q(o,"Denied")},{default:i(()=>[...e[18]||(e[18]=[m("Deny",-1)])]),_:2},1032,["onClick"])],64)):f("",!0),n(s(x),{variant:"secondary",size:"sm",onClick:P=>q(o)},{default:i(()=>[...e[19]||(e[19]=[m("Edit",-1)])]),_:2},1032,["onClick"])])])]))),128))])])])):(r(),d("div",ke,[...e[20]||(e[20]=[t("p",null,"There are no leave requests to review.",-1)])])),t("div",ye,[a.leaveRequests.data.length>0?(r(),v(h,{key:0,links:a.leaveRequests.links},null,8,["links"])):f("",!0)])])]),n(s(Q),{open:_.value,"onUpdate:open":e[8]||(e[8]=o=>_.value=o)},{default:i(()=>[n(s(W),null,{default:i(()=>[n(s(X),null,{default:i(()=>[n(s(Z),null,{default:i(()=>[m("Confirm Action: "+u(s(l).status)+" Request",1)]),_:1}),n(s(ee),null,{default:i(()=>[b.value?(r(),d("span",xe," You are about to "+u(s(l).status.toLowerCase())+" this leave request for **"+u(b.value.staff.first_name)+" "+u(b.value.staff.last_name)+"**. ",1)):(r(),d("span",we," You are about to "+u(s(l).status.toLowerCase())+" a leave request. ",1)),e[22]||(e[22]=m(" You can add an optional note below. ",-1))]),_:1})]),_:1}),t("div",Ce,[t("div",he,[n(s(U),{for:"status"},{default:i(()=>[...e[23]||(e[23]=[m("Status",-1)])]),_:1}),R(t("select",{id:"status","onUpdate:modelValue":e[5]||(e[5]=o=>s(l).status=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring-primary dark:border-gray-600 dark:bg-gray-700 dark:text-white"},[...e[24]||(e[24]=[t("option",{value:"Pending"},"Pending",-1),t("option",{value:"Approved"},"Approved",-1),t("option",{value:"Denied"},"Denied",-1)])],512),[[L,s(l).status]]),s(l).errors.status?(r(),d("div",Re,u(s(l).errors.status),1)):f("",!0)]),n(s(U),{for:"admin_notes"},{default:i(()=>[...e[25]||(e[25]=[m("Notes (Optional)",-1)])]),_:1}),R(t("textarea",{id:"admin_notes","onUpdate:modelValue":e[6]||(e[6]=o=>s(l).admin_notes=o),placeholder:"Reason for denial, etc.",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring-primary dark:border-gray-600 dark:bg-gray-700 dark:text-white"},null,512),[[B,s(l).admin_notes]]),s(l).errors.admin_notes?(r(),d("div",De,u(s(l).errors.admin_notes),1)):f("",!0)]),n(s(te),null,{default:i(()=>[n(s(x),{variant:"outline",onClick:e[7]||(e[7]=o=>_.value=!1),disabled:s(l).processing},{default:i(()=>[...e[26]||(e[26]=[m("Cancel",-1)])]),_:1},8,["disabled"]),n(s(x),{onClick:T,disabled:s(l).processing},{default:i(()=>[...e[27]||(e[27]=[m("Confirm",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})],64)}}}),Ye=se(Se,[["__scopeId","data-v-41c09fec"]]);export{Ye as default};
