var e,t,r,n,i,o,a,s,l,c;function u(){if(t)return e;t=1;var r=String.prototype.replace,n=/%20/g,i="RFC3986";return e={default:i,formatters:{RFC1738:function(e){return r.call(e,n,"+")},RFC3986:function(e){return String(e)}},RFC1738:"RFC1738",RFC3986:i}}function f(){if(n)return r;n=1;var e=u(),t=Object.prototype.hasOwnProperty,i=Array.isArray,o=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),a=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)void 0!==e[n]&&(r[n]=e[n]);return r};return r={arrayToObject:a,assign:function(e,t){return Object.keys(t).reduce(function(e,r){return e[r]=t[r],e},e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],n=0;n<t.length;++n)for(var o=t[n],a=o.obj[o.prop],s=Object.keys(a),l=0;l<s.length;++l){var c=s[l],u=a[c];"object"==typeof u&&null!==u&&-1===r.indexOf(u)&&(t.push({obj:a,prop:c}),r.push(u))}return function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(i(r)){for(var n=[],o=0;o<r.length;++o)void 0!==r[o]&&n.push(r[o]);t.obj[t.prop]=n}}}(t),e},decode:function(e,t,r){var n=e.replace(/\+/g," ");if("iso-8859-1"===r)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(y){return n}},encode:function(t,r,n,i,a){if(0===t.length)return t;var s=t;if("symbol"==typeof t?s=Symbol.prototype.toString.call(t):"string"!=typeof t&&(s=String(t)),"iso-8859-1"===n)return escape(s).replace(/%u[0-9a-f]{4}/gi,function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"});for(var l="",c=0;c<s.length;++c){var u=s.charCodeAt(c);45===u||46===u||95===u||126===u||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||a===e.RFC1738&&(40===u||41===u)?l+=s.charAt(c):u<128?l+=o[u]:u<2048?l+=o[192|u>>6]+o[128|63&u]:u<55296||u>=57344?l+=o[224|u>>12]+o[128|u>>6&63]+o[128|63&u]:(c+=1,u=65536+((1023&u)<<10|1023&s.charCodeAt(c)),l+=o[240|u>>18]+o[128|u>>12&63]+o[128|u>>6&63]+o[128|63&u])}return l},isBuffer:function(e){return!(!e||"object"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(i(e)){for(var r=[],n=0;n<e.length;n+=1)r.push(t(e[n]));return r}return t(e)},merge:function e(r,n,o){if(!n)return r;if("object"!=typeof n){if(i(r))r.push(n);else{if(!r||"object"!=typeof r)return[r,n];(o&&(o.plainObjects||o.allowPrototypes)||!t.call(Object.prototype,n))&&(r[n]=!0)}return r}if(!r||"object"!=typeof r)return[r].concat(n);var s=r;return i(r)&&!i(n)&&(s=a(r,o)),i(r)&&i(n)?(n.forEach(function(n,i){if(t.call(r,i)){var a=r[i];a&&"object"==typeof a&&n&&"object"==typeof n?r[i]=e(a,n,o):r.push(n)}else r[i]=n}),r):Object.keys(n).reduce(function(r,i){var a=n[i];return t.call(r,i)?r[i]=e(r[i],a,o):r[i]=a,r},s)}},r}function p(){if(o)return i;o=1;var e=f(),t=u(),r=Object.prototype.hasOwnProperty,n={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},a=Array.isArray,s=String.prototype.split,l=Array.prototype.push,c=function(e,t){l.apply(e,a(t)?t:[t])},p=Date.prototype.toISOString,d=t.default,h={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:e.encode,encodeValuesOnly:!1,format:d,formatter:t.formatters[d],indices:!1,serializeDate:function(e){return p.call(e)},skipNulls:!1,strictNullHandling:!1},y=function t(r,n,i,o,l,u,f,p,d,y,m,g,b,v){var w,O=r;if("function"==typeof f?O=f(n,O):O instanceof Date?O=y(O):"comma"===i&&a(O)&&(O=e.maybeMap(O,function(e){return e instanceof Date?y(e):e})),null===O){if(o)return u&&!b?u(n,h.encoder,v,"key",m):n;O=""}if("string"==typeof(w=O)||"number"==typeof w||"boolean"==typeof w||"symbol"==typeof w||"bigint"==typeof w||e.isBuffer(O)){if(u){var j=b?n:u(n,h.encoder,v,"key",m);if("comma"===i&&b){for(var $=s.call(String(O),","),S="",x=0;x<$.length;++x)S+=(0===x?"":",")+g(u($[x],h.encoder,v,"value",m));return[g(j)+"="+S]}return[g(j)+"="+g(u(O,h.encoder,v,"value",m))]}return[g(n)+"="+g(String(O))]}var P,N=[];if(void 0===O)return N;if("comma"===i&&a(O))P=[{value:O.length>0?O.join(",")||null:void 0}];else if(a(f))P=f;else{var E=Object.keys(O);P=p?E.sort(p):E}for(var A=0;A<P.length;++A){var k=P[A],D="object"==typeof k&&void 0!==k.value?k.value:O[k];if(!l||null!==D){var R=a(O)?"function"==typeof i?i(n,k):n:n+(d?"."+k:"["+k+"]");c(N,t(D,R,i,o,l,u,f,p,d,y,m,g,b,v))}}return N};return i=function(e,i){var o,s=e,l=function(e){if(!e)return h;if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var n=e.charset||h.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var i=t.default;if(void 0!==e.format){if(!r.call(t.formatters,e.format))throw new TypeError("Unknown format option provided.");i=e.format}var o=t.formatters[i],s=h.filter;return("function"==typeof e.filter||a(e.filter))&&(s=e.filter),{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:h.addQueryPrefix,allowDots:void 0===e.allowDots?h.allowDots:!!e.allowDots,charset:n,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:h.charsetSentinel,delimiter:void 0===e.delimiter?h.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:h.encode,encoder:"function"==typeof e.encoder?e.encoder:h.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:h.encodeValuesOnly,filter:s,format:i,formatter:o,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:h.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:h.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:h.strictNullHandling}}(i);"function"==typeof l.filter?s=(0,l.filter)("",s):a(l.filter)&&(o=l.filter);var u,f=[];if("object"!=typeof s||null===s)return"";u=i&&i.arrayFormat in n?i.arrayFormat:i&&"indices"in i?i.indices?"indices":"repeat":"indices";var p=n[u];o||(o=Object.keys(s)),l.sort&&o.sort(l.sort);for(var d=0;d<o.length;++d){var m=o[d];l.skipNulls&&null===s[m]||c(f,y(s[m],m,p,l.strictNullHandling,l.skipNulls,l.encode?l.encoder:null,l.filter,l.sort,l.allowDots,l.serializeDate,l.format,l.formatter,l.encodeValuesOnly,l.charset))}var g=f.join(l.delimiter),b=!0===l.addQueryPrefix?"?":"";return l.charsetSentinel&&("iso-8859-1"===l.charset?b+="utf8=%26%2310003%3B&":b+="utf8=%E2%9C%93&"),g.length>0?b+g:""},i}function d(){if(s)return a;s=1;var e=f(),t=Object.prototype.hasOwnProperty,r=Array.isArray,n={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:e.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},i=function(e){return e.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},o=function(e,t){return e&&"string"==typeof e&&t.comma&&e.indexOf(",")>-1?e.split(","):e},l=function(e,r,n,i){if(e){var a=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,s=/(\[[^[\]]*])/g,l=n.depth>0&&/(\[[^[\]]*])/.exec(a),c=l?a.slice(0,l.index):a,u=[];if(c){if(!n.plainObjects&&t.call(Object.prototype,c)&&!n.allowPrototypes)return;u.push(c)}for(var f=0;n.depth>0&&null!==(l=s.exec(a))&&f<n.depth;){if(f+=1,!n.plainObjects&&t.call(Object.prototype,l[1].slice(1,-1))&&!n.allowPrototypes)return;u.push(l[1])}return l&&u.push("["+a.slice(l.index)+"]"),function(e,t,r,n){for(var i=n?t:o(t,r),a=e.length-1;a>=0;--a){var s,l=e[a];if("[]"===l&&r.parseArrays)s=[].concat(i);else{s=r.plainObjects?Object.create(null):{};var c="["===l.charAt(0)&&"]"===l.charAt(l.length-1)?l.slice(1,-1):l,u=parseInt(c,10);r.parseArrays||""!==c?!isNaN(u)&&l!==c&&String(u)===c&&u>=0&&r.parseArrays&&u<=r.arrayLimit?(s=[])[u]=i:"__proto__"!==c&&(s[c]=i):s={0:i}}i=s}return i}(u,r,n,i)}};return a=function(a,s){var c=function(t){if(!t)return n;if(null!==t.decoder&&void 0!==t.decoder&&"function"!=typeof t.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=void 0===t.charset?n.charset:t.charset;return{allowDots:void 0===t.allowDots?n.allowDots:!!t.allowDots,allowPrototypes:"boolean"==typeof t.allowPrototypes?t.allowPrototypes:n.allowPrototypes,arrayLimit:"number"==typeof t.arrayLimit?t.arrayLimit:n.arrayLimit,charset:r,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:n.charsetSentinel,comma:"boolean"==typeof t.comma?t.comma:n.comma,decoder:"function"==typeof t.decoder?t.decoder:n.decoder,delimiter:"string"==typeof t.delimiter||e.isRegExp(t.delimiter)?t.delimiter:n.delimiter,depth:"number"==typeof t.depth||!1===t.depth?+t.depth:n.depth,ignoreQueryPrefix:!0===t.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof t.interpretNumericEntities?t.interpretNumericEntities:n.interpretNumericEntities,parameterLimit:"number"==typeof t.parameterLimit?t.parameterLimit:n.parameterLimit,parseArrays:!1!==t.parseArrays,plainObjects:"boolean"==typeof t.plainObjects?t.plainObjects:n.plainObjects,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:n.strictNullHandling}}(s);if(""===a||null==a)return c.plainObjects?Object.create(null):{};for(var u="string"==typeof a?function(a,s){var l,c={},u=s.ignoreQueryPrefix?a.replace(/^\?/,""):a,f=s.parameterLimit===1/0?void 0:s.parameterLimit,p=u.split(s.delimiter,f),d=-1,h=s.charset;if(s.charsetSentinel)for(l=0;l<p.length;++l)0===p[l].indexOf("utf8=")&&("utf8=%E2%9C%93"===p[l]?h="utf-8":"utf8=%26%2310003%3B"===p[l]&&(h="iso-8859-1"),d=l,l=p.length);for(l=0;l<p.length;++l)if(l!==d){var y,m,g=p[l],b=g.indexOf("]="),v=-1===b?g.indexOf("="):b+1;-1===v?(y=s.decoder(g,n.decoder,h,"key"),m=s.strictNullHandling?null:""):(y=s.decoder(g.slice(0,v),n.decoder,h,"key"),m=e.maybeMap(o(g.slice(v+1),s),function(e){return s.decoder(e,n.decoder,h,"value")})),m&&s.interpretNumericEntities&&"iso-8859-1"===h&&(m=i(m)),g.indexOf("[]=")>-1&&(m=r(m)?[m]:m),t.call(c,y)?c[y]=e.combine(c[y],m):c[y]=m}return c}(a,c):a,f=c.plainObjects?Object.create(null):{},p=Object.keys(u),d=0;d<p.length;++d){var h=p[d],y=l(h,u[h],c,"string"==typeof a);f=e.merge(f,y,c)}return e.compact(f)},a}var h=function(){if(c)return l;c=1;var e=p(),t=d(),r=u();return l={formats:r,parse:t,stringify:e}}();function y(){return y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},y.apply(null,arguments)}class m{constructor(e,t,r){var n,i;this.name=e,this.definition=t,this.bindings=null!=(n=t.bindings)?n:{},this.wheres=null!=(i=t.wheres)?i:{},this.config=r}get template(){const e=`${this.origin}/${this.definition.uri}`.replace(/\/+$/,"");return""===e?"/":e}get origin(){return this.config.absolute?this.definition.domain?`${this.config.url.match(/^\w+:\/\//)[0]}${this.definition.domain}${this.config.port?`:${this.config.port}`:""}`:this.config.url:""}get parameterSegments(){var e,t;return null!=(e=null==(t=this.template.match(/{[^}?]+\??}/g))?void 0:t.map(e=>({name:e.replace(/{|\??}/g,""),required:!/\?}$/.test(e)})))?e:[]}matchesUrl(e){var t;if(!this.definition.methods.includes("GET"))return!1;const r=this.template.replace(/[.*+$()[\]]/g,"\\$&").replace(/(\/?){([^}?]*)(\??)}/g,(e,t,r,n)=>{var i;const o=`(?<${r}>${(null==(i=this.wheres[r])?void 0:i.replace(/(^\^)|(\$$)/g,""))||"[^/?]+"})`;return n?`(${t}${o})?`:`${t}${o}`}).replace(/^\w+:\/\//,""),[n,i]=e.replace(/^\w+:\/\//,"").split("?"),o=null!=(t=new RegExp(`^${r}/?$`).exec(n))?t:new RegExp(`^${r}/?$`).exec(decodeURI(n));if(o){for(const e in o.groups)o.groups[e]="string"==typeof o.groups[e]?decodeURIComponent(o.groups[e]):o.groups[e];return{params:o.groups,query:h.parse(i)}}return!1}compile(e){return this.parameterSegments.length?this.template.replace(/{([^}?]+)(\??)}/g,(t,r,n)=>{var i,o;if(!n&&[null,void 0].includes(e[r]))throw new Error(`Ziggy error: '${r}' parameter is required for route '${this.name}'.`);if(this.wheres[r]&&!new RegExp(`^${n?`(${this.wheres[r]})?`:this.wheres[r]}$`).test(null!=(o=e[r])?o:""))throw new Error(`Ziggy error: '${r}' parameter '${e[r]}' does not match required format '${this.wheres[r]}' for route '${this.name}'.`);return encodeURI(null!=(i=e[r])?i:"").replace(/%7C/g,"|").replace(/%25/g,"%").replace(/\$/g,"%24")}).replace(this.config.absolute?/(\.[^/]+?)(\/\/)/:/(^)(\/\/)/,"$1/").replace(/\/+$/,""):this.template}}class g extends String{constructor(e,t,r=!0,n){if(super(),this.t=null!=n?n:"undefined"!=typeof Ziggy?Ziggy:null==globalThis?void 0:globalThis.Ziggy,this.t=y({},this.t,{absolute:r}),e){if(!this.t.routes[e])throw new Error(`Ziggy error: route '${e}' is not in the route list.`);this.i=new m(e,this.t.routes[e],this.t),this.o=this.u(t)}}toString(){const e=Object.keys(this.o).filter(e=>!this.i.parameterSegments.some(({name:t})=>t===e)).filter(e=>"_query"!==e).reduce((e,t)=>y({},e,{[t]:this.o[t]}),{});return this.i.compile(this.o)+h.stringify(y({},e,this.o._query),{addQueryPrefix:!0,arrayFormat:"indices",encodeValuesOnly:!0,skipNulls:!0,encoder:(e,t)=>"boolean"==typeof e?Number(e):t(e)})}h(e){e?this.t.absolute&&e.startsWith("/")&&(e=this.l().host+e):e=this.m();let t={};const[r,n]=Object.entries(this.t.routes).find(([r,n])=>t=new m(r,n,this.t).matchesUrl(e))||[void 0,void 0];return y({name:r},t,{route:n})}m(){const{host:e,pathname:t,search:r}=this.l();return(this.t.absolute?e+t:t.replace(this.t.url.replace(/^\w*:\/\/[^/]+/,""),"").replace(/^\/+/,"/"))+r}current(e,t){const{name:r,params:n,query:i,route:o}=this.h();if(!e)return r;const a=new RegExp(`^${e.replace(/\./g,"\\.").replace(/\*/g,".*")}$`).test(r);if([null,void 0].includes(t)||!a)return a;const s=new m(r,o,this.t);t=this.u(t,s);const l=y({},n,i);if(Object.values(t).every(e=>!e)&&!Object.values(l).some(e=>void 0!==e))return!0;const c=(e,t)=>Object.entries(e).every(([e,r])=>Array.isArray(r)&&Array.isArray(t[e])?r.every(r=>t[e].includes(r)):"object"==typeof r&&"object"==typeof t[e]&&null!==r&&null!==t[e]?c(r,t[e]):t[e]==r);return c(t,l)}l(){var e,t,r,n,i,o;const{host:a="",pathname:s="",search:l=""}="undefined"!=typeof window?window.location:{};return{host:null!=(e=null==(t=this.t.location)?void 0:t.host)?e:a,pathname:null!=(r=null==(n=this.t.location)?void 0:n.pathname)?r:s,search:null!=(i=null==(o=this.t.location)?void 0:o.search)?i:l}}get params(){const{params:e,query:t}=this.h();return y({},e,t)}get routeParams(){return this.h().params}get queryParams(){return this.h().query}has(e){return this.t.routes.hasOwnProperty(e)}u(e={},t=this.i){null!=e||(e={}),e=["string","number"].includes(typeof e)?[e]:e;const r=t.parameterSegments.filter(({name:e})=>!this.t.defaults[e]);return Array.isArray(e)?e=e.reduce((e,t,n)=>y({},e,r[n]?{[r[n].name]:t}:"object"==typeof t?t:{[t]:""}),{}):1!==r.length||e[r[0].name]||!e.hasOwnProperty(Object.values(t.bindings)[0])&&!e.hasOwnProperty("id")||(e={[r[0].name]:e}),y({},this.$(t),this.p(e,t))}$(e){return e.parameterSegments.filter(({name:e})=>this.t.defaults[e]).reduce((e,{name:t},r)=>y({},e,{[t]:this.t.defaults[t]}),{})}p(e,{bindings:t,parameterSegments:r}){return Object.entries(e).reduce((e,[n,i])=>{if(!i||"object"!=typeof i||Array.isArray(i)||!r.some(({name:e})=>e===n))return y({},e,{[n]:i});if(!i.hasOwnProperty(t[n])){if(!i.hasOwnProperty("id"))throw new Error(`Ziggy error: object passed as '${n}' parameter is missing route model binding key '${t[n]}'.`);t[n]="id"}return y({},e,{[n]:i[t[n]]})},{})}valueOf(){return this.toString()}}function b(e,t,r,n){const i=new g(e,t,r,n);return e?i.toString():i}const v={install(e,t){const r=(e,r,n,i=t)=>b(e,r,n,i);parseInt(e.version)>2?(e.config.globalProperties.route=r,e.provide("route",r)):e.mixin({methods:{route:r}})}};export{v as o};
